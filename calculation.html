<!DOCTYPE html>
<html>
<head>
    <title>Calculator</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <h1>Calculator</h1>
    <div class="formstyle">
        <div id="history"></div>
        <form name="form">
            <input id="calc" type="text" name="answer"
                oninput="typedByKeyboard();"
            >
            <div id="history"></div>
            <div id="buttons"></div>
            <input type="button"
                onclick="addOperatorsToInputBox(operatorButtonValue = '&radic;')"
            value="&radic;">
        </form>
        <input type="button" value="Clear All"
            id="clear"
            onclick="clearInputBoxAndHistory()"
        >
    </div>

    <script>
        var numbers = [0, 1, 2, 3, 4, 5, 6, 7, 8, 9];
        var operators = ['+', '-', '*', '/', "x2", '%', '='];
        var inputBoxValue = '';
        var evaluationDone = false;
        var calculationHistory = [];


        displayNumbersInHtml();
        displayOperatorsInHtml();
        onPressEnterAndGetInputBoxValueAndDisplayAnswer();

        function checkAndClearInputBoxIfEvaluationDone() {
            if (evaluationDone) {
                document.getElementById('calc').value = '';
                evaluationDone = false;
            }
        }

        function displayNumbersInHtml() {

            for (i = 0; i < numbers.length; i++)
            {
                numberButtons = document.createElement("button");
                numberButtons.setAttribute("type", "button" );
                numberButtons.innerHTML = numbers[i];
                numberButtons.setAttribute("value", i);
                numberButtons.setAttribute("onclick", 'addNumbersToInputBox(numberButtonValue = value)' );
                document.getElementById("buttons").appendChild(numberButtons);
            }
        }

       function displayOperatorsInHtml() {
            for (i = 0; i < operators.length; i++) {
                operatorButtons=document.createElement("button");
                operatorButtons.setAttribute("type", "button" ); operatorButtons.innerHTML=operators[i];
                operatorButtons.setAttribute("value", operators[i]);
                if (operators[i] === '=' ) {
                    operatorButtons.setAttribute("onclick", 'getInputBoxValueAndDisplayAnswerAndHistory()' );
                }
                else {
                    operatorButtons.setAttribute("onclick", 'addOperatorsToInputBox(operatorButtonValue = value)' );
                }
                document.getElementById("buttons").appendChild(operatorButtons);
            }
       }

        function addNumbersToInputBox(numberButtonValue) {
            checkAndClearInputBoxIfEvaluationDone();
            document.getElementById('calc').value += numberButtonValue;
        }

        function addOperatorsToInputBox(operatorButtonValue) {
            if (operatorButtonValue == 'x2') {
                operatorButtonValue = "x";
            }

            document.getElementById('calc').value += operatorButtonValue;
            evaluationDone = false;
        }

        function onPressEnterAndGetInputBoxValueAndDisplayAnswer() {
            document.getElementById('calc').addEventListener("keypress", function (event) {
                if (event.key === "Enter") {
                    event.preventDefault();
                    getInputBoxValueAndDisplayAnswerAndHistory();
                }
            });
        }

        function getInputBoxValueAndDisplayAnswerAndHistory() {
            inputBoxValue = document.getElementById('calc').value;
            lastCharacter = document.getElementById('calc').value.charAt(inputBoxValue.length - 1);

            function checkForPercentageSignAndReplaceWithPercentageFormula() {
                inputBoxValue = inputBoxValue.replace('%', '/100');
                // it check when '%' percentage symbol in input box value
                //and Replace with '/100 'divide by 100 for getting percentages
            }

            checkForPercentageSignAndReplaceWithPercentageFormula();

            if (isSquareRootSign(inputBoxValue)) {
                removeRadicCharacter = inputBoxValue.substring(1);
                squareRootAnswer = Math.sqrt(removeRadicCharacter);
                calculationAnswer = squareRootAnswer;

            } else if (lastCharacter == 'x') {
                removeXSquareSign = inputBoxValue.substring(0, inputBoxValue.length - 1);
                calculationAnswer = removeXSquareSign * removeXSquareSign;
            }
            else if (lastCharacter == '=') {
                removeLastCharacter = inputBoxValue.substring(0, inputBoxValue.length - 1);
                calculationAnswer = eval(removeLastCharacter);
            }

            else {
                calculationAnswer = eval(inputBoxValue);
            }

            document.getElementById('calc').value = calculationAnswer;


                calculationHistory.push(inputBoxValue + '=' + calculationAnswer + "<br>");

            document.getElementById('history').innerHTML = "<p>" + calculationHistory + "</p> <br>";
            evaluationDone = true;
        }

        function isSquareRootSign(inputBoxValue) {
            return inputBoxValue.charAt(0).charCodeAt(0) === 8730;
        }

        function typedByKeyboard() {
            inputBoxValue = document.getElementById('calc').value;
            lastCharacter = document.getElementById('calc').value.charAt(inputBoxValue.length - 1);

            if (lastCharacter == '=') {
                getInputBoxValueAndDisplayAnswerAndHistory();
                return;
            }

            if (!evaluationDone) {
                return;
            }

            if (isNumberTyped()) {
                document.getElementById('calc').value = lastCharacter;
            }

            evaluationDone = false;
        }

        function isNumberTyped() {
            inputBoxValue = document.getElementById('calc').value;
            lastCharacter = document.getElementById('calc').value.charAt(inputBoxValue.length - 1);
            lastCharacter = parseInt(lastCharacter);
             if (numbers.includes(lastCharacter)) {
                    return true;
             }
            return false;
        }

        function clearInputBoxAndHistory() {
            document.getElementById('calc').value = '';
            document.getElementById('history').innerHTML = '';
            calculationHistory = [];
        }
    </script>
</body>

</html>